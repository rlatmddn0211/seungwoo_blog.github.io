---
layout: post
title: "AI+X 선도인재양성프로젝트 초급반 (EDA - 2)"
date: 2025-01-31 10:00:00 +0900
categories: ["AI", "Projects"]
---
Nov 01, 2024 ~ Dec 13, 2024

📌 EDA 두번째 프로젝트는 KT 교수님께서 주신 스마트폰 기반의 센서 데이터를 분석해보고 이를 활용한 사업 아이디어를 발굴해보는 프로젝트였다. 이 프로젝트를 본격적으로 진행하기 전, '인간 행동 인식' HAR : Human Activity Recognition 이라는 것이 무엇인지부터 알아야한다. HAR이란 다양한 센서를 활용하여 사람의 모션에 관련된 정보를 수집하고 해석하여 행동을 인식하는 기술이다.이 기술은 현재 보편적으로 사용되고 있다. 활용 예시 중 하나는 스마트워치이다. 애플 워치, 겔럭시 워치 등과 같은 스마트워치에는 HAR이 내장되어있다. 워치로부터 센서 신호를 받고 특징을 추출하여 모델을 학습시키고 행동을 추론하는 과정을 거쳐 사용자의 행동을 추론하고 이에 맞는 여러 서비스를 제공한다. 그리고 우린 스마트폰 기반의 센서데이터를 받을 수 있었다.
<p style="text-align:center;"><strong>인간 행동 인식 (HAR : Human Activity Recognition)</strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/har.png" width =700>
</center>

📌 우리가 받은 데이터는 'Human Activity Using Smartphone Data Set'이다. 이전에 진행했었던 지하철 데이터와는 좀 많이 달랐다. 우선 5881 x 563 크기여서 처음에 당황했지만 나중에 현직자가 되면 더 큰 데이터셋도 마주할것이라고 생각했다. 데이터에는 6가지의 동작이 구분되어 있고, 이 동작을 구분하는 변수들이 존재한다.

<p style="text-align:center;"><strong>6가지의 동작 종류</strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/activity.png" width =700>
</center>

📌 처음에 개인 미션으로 주어진 데이터를 탐색하고, 기본 모델을 (Random Forest 알고리즘 활용) 생성한 후 변수 중요도를 구한다. 그 후 중요한 feature와 중요하지 않은 feature들을 구분하고 각 feature 그룹별 중요도도 파악해보며 데이터와 친해진 후, 이를 활용한 사업아이템을 발굴해보았다. <strong>Feature들을 중요도 순으로 구분해보는 과정은 매우 중요하다. 실무에서는 수천,수만개의 데이터 핸들링이 필요하고, 많은 데이터를 모두 다 핸들링하기보다는 데이터 분석을 통해 데이터의 피쳐를 줄이고 간소화하는 작업을 해보는 것이 프로젝트의 핵심이라고 생각했다.</strong>

데이터에 포함된 변수들은 크게 가속도계로 측정한 Acc(중력가속도), 자이로스코프로 측정한 Gyro(각속도), 가속도의 변화율을 나타내는 Jerk, 자기장 센서로 측정된 Mag, 그리고 각과 관련된 Angle 변수들이 존재한다. 

📌 우선 첫번째로 6가지의 Activity들을 구분하기 위한 데이터 전처리와 모델링을 진행하였다. RandomForest 알고리즘을 사용하였고, 코드를 보면 Target은 'Activity'로 되어있고, 학습하는데 있어서 불필요한 데이터인 Target(예측값이기 때문에)과 동작을 구분하기 위해 1~6의 숫자를 부여한 Activity_num column은 제외하였다. 과적합을 방지하기 위하여 test_size=.3으로 설정하여 검증 데이터는 입력 데이터중 30%로 설정하였다.

<p style="text-align:center;"><strong> 데이터 전처리 </strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/modeling1.png" width =700>
</center>

<p style="text-align:center;"><strong>모델링</strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/modeling2.png" width =700>
</center>

<p style="text-align:center;"><strong>학습 결과(예측 정확도)</strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/modeling3.png" width =700>
</center>

📌 학습결과와 예측정확도를 보니 과적합된 것 같지는 않았고, 혼자 진행해보며 '잘 예측하는데?'라는 생각을 혼자했었던게 기억이 난다. 이제 학습시킨 모델을 가지고 동작들을 구분하는데 있어서 중요한 변수들을 추출해보았다.

<p style="text-align:center;"><strong>변수 중요도 추출</strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/modeling4.png" width =450 height=360>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/modelresult.png" width =450 height=360>
</center>

📌 6가지의 동작들을 구분하는데 있어서 가장 중요한 feature, 변수는 <strong>tGravityAcc-min()-X</strong>이었고, 결과를 확인해보면 상위 10가지의 변수 중 무려 8개가 중력가속도와 관련된 변수인 것을 확인해볼 수 있었다. 그렇다면 중요도가 높은 변수들의 값을 각각의 6가지의 동작들에서 어떠한 밀집도를 가지며 분포하는지 KDE plot을 통해 확인해보았다.

<p style="text-align:center;"><strong>중요도 Top5 KDE plot</strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/top5kde.png" width =700>
</center>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/kdeplott.png" width =300 height=360>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/kdeplott2.png" width =300 height=360>
</center>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/kdeplott3.png" width =300 height=360>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/kdeplott4.png" width =300 height=360>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/kdeplott5.png" width =300 height=360>
</center>

📌 이렇게 변수들의 중요도를 파악해본 후, 각 동작들을 구분하는데 있어서 중요한 변수들도 확인해보았다. is_동작 (sitting,standing..)과 같이 6개의 동작을 구분하는 (해당변수에만 1 부여, 나머지는 0 부여) 변수를 생성하고, 각각의 동작을 mapping하고, 앞서 모델을 학습하는 방식과 같이 학습하는데 있어서 불필요한 변수들은 제거하고, target을 새롭게 생성한 변수로 설정하고 모델 학습을 진행시킨다. 

<p style="text-align:center;"><strong>동작을 구분하는 변수 중요도 (Standing)</strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/standing.png" width =700>
</center>

<p style="text-align:center;"><strong>Standing 동작과 관련된 모델 예측 정확도</strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/standingresult.png" width =700>
</center>

<p style="text-align:center;"><strong>Standing 동작을 구분하기 위한 변수 중요도 Top5</strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/standingresult.png" width =700>
</center>

📌 변수중요도를 확인한 후, 변수들을 sensor별, agg별, axis별로 정리해놓은 feature 데이터셋에 fi_standing(동작6가지) 중요도 값을 가지는 새로운 변수를 추가하고 변수들의 중요도를 시각화하는 과정을 6가지의 동작 모두 거친다. 사진은 6가지의 동작 중 하나인 'Standing' 앉아있는 자세에서의 변수중요도와 관련된 내용이다.

<p style="text-align:center;"><strong> fi_standing 추가 </strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/fistanding.png" width =700>
</center>

<p style="text-align:center;"><strong> 변수 중요도 시각화 </strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/standingplot.png" width =700>
</center>

💡 위의 그래프를 확인해보면 'tGravityAcc' 즉 시간대 영역의 중력가속도의 중요도가 가장 높다는 것을 시각화를 통해 확인해볼 수 있었다.
서있는 자세뿐만 아니라 데이터에서 주어진 모든 자세들에 대해서도 시각화를 진행했다. 각각의 자세들에 대한 중요도를 살펴보겠다.

<p style="text-align:center;"><strong> 앉아있는 자세에서의 변수중요도 시각화 (Sitting) </strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/sitting.png" width =700>
</center>

<p style="text-align:center;"><strong> 누워있는 자세에서의 변수중요도 시각화 (Laying) </strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/laying.png" width =700>
</center>

<p style="text-align:center;"><strong> 걷는 자세에서의 변수중요도 시각화 (Walking) </strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/walking.png" width =700>
</center>

<p style="text-align:center;"><strong> 계단을 올라가는 자세에서의 변수중요도 시각화 (Walking Upstairs) </strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/walkingup.png" width =700>
</center>

<p style="text-align:center;"><strong> 계단을 내려가는 자세에서의 변수중요도 시각화 (Walking Downstairs) </strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/walkingdown.png" width =700>
</center>

각 동작에서의 중요도를 정리해보았다.

✔ 앉아있는 자세에서는 'tGravityAcc'(중력가속도)와 'fBodyGyro'(신체각속도)에 관련된 변수들의 중요도가 높다. 앉아있는 자세에서 몸의 기울기나 자세의 안정성에 따라 중력가속도의 값이 달라지고, 앉은 자세에서 상체의 회전이나 균형을 잡으려고하는 미세한 움직임 등이 자주 일어나기 때문에 신체각속도 값이 중요하다.

✔ 누워있는 자세에서는 'tGravityAcc'(중력가속도)의 중요도가 특히 높다는 것을 확인할 수 있다. 그 이유는 누워있는 자세에서는 중력이 수평으로 일정하게 작용하기 때문에 중력의 영향이 가장 뚜렷하게 나타나는 자세이다. 또한 6가지의 동작 중 유일하게 신체가 중력과 수평의 방향으로 위치해있는 동작이기도 하다.

✔ 걷는 자세에서는 신체가속도의 크기 즉, 걷는 동작을 수행하는 동안 몸이 얼마나 빠르게 움직이는지를 측정하는            'fBodyAccMag'변수와 걷는 동안 가속도(속도변화)가 얼마나 급격히 변화하는지 나타내는 'fBodyAccJerk' 변수, 그리고 신체의 가속도를 나타내는 변수인 'fBodyAcc' 변수와 'tGravityAcc'(중력가속도)를 나타내는 변수들의 중요도가 높은 것을 확인할 수 있다.

✔ 계단을 올라가는 자세에서도 마찬가지로 수직방향으로 강한 힘이 작용하기 때문에 다른 동작들과 마찬가지로 'tGravityAcc' 중력가속도와, 계단을 오르며 발생하는 상체와 하체의 움직임과 신체가 얼마나 급격히 변화하는지 나타내는 변수인 'fBodyAcc','fBodyAccJerk' 변수들이 중요한 것을 확인할 수 있었다.

✔ 계단을 내려가는 자세에서는 몸이 아래로 내려가는 방향으로 중력이 작용하므로, 'tGravityAccMag' 중력가속도 크기 변수로 수직하강운동을 감지할 수 있다. 또한 계단을 내려갈때 발생하는 하강가속도 및 몸의 움직임을 추적하는 'fBodyAccMag','fBodyAcc' 변수들이 중요하다.

✅  앞서 정리한 내용들을 보면, 공통적으로 각각의 동작들을 구분하는데 영향을 많이 주는 변수들에는 크게 중력가속도(GravityAcc), 그리고 몸의 움직임을 측정하는 신체가속도 (BodyAcc), 그리고 신체의 회전을 나타내는 신체각속도 (BodyGyro), 움직임의 급격한 변화를 추적할 수 있는 가속도 변화 (BodyAccJerk) 변수들이 중요하게 작용하는 것을 확인할 수 있었다.








