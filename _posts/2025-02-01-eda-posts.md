---
layout: post
title: "AI+X 선도인재양성프로젝트 초급반 (EDA - 2)"
date: 2025-01-31 10:00:00 +0900
categories: ["AI", "Projects"]
---
Nov 01, 2024 ~ Dec 13, 2024

EDA 두번째 프로젝트는 KT 교수님께서 주신 스마트폰 기반의 센서 데이터를 분석해보고 이를 활용한 사업 아이디어를 발굴해보는 프로젝트였다. 이 프로젝트를 본격적으로 진행하기 전, '인간 행동 인식' HAR : Human Activity Recognition 이라는 것이 무엇인지부터 알아야한다. HAR이란 다양한 센서를 활용하여 사람의 모션에 관련된 정보를 수집하고 해석하여 행동을 인식하는 기술이다.이 기술은 현재 보편적으로 사용되고 있다. 활용 예시 중 하나는 스마트워치이다. 애플 워치, 겔럭시 워치 등과 같은 스마트워치에는 HAR이 내장되어있다. 워치로부터 센서 신호를 받고 특징을 추출하여 모델을 학습시키고 행동을 추론하는 과정을 거쳐 사용자의 행동을 추론하고 이에 맞는 여러 서비스를 제공한다. 그리고 우린 스마트폰 기반의 센서데이터를 받을 수 있었다.
<p style="text-align:center;"><strong>인간 행동 인식 (HAR : Human Activity Recognition)</strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/har.png" width =700>
</center>

우리가 받은 데이터는 'Human Activity Using Smartphone Data Set'이다. 이전에 진행했었던 지하철 데이터와는 좀 많이 달랐다. 우선 5881 x 563 크기여서 처음에 당황했지만 나중에 현직자가 되면 더 큰 데이터셋도 마주할것이라고 생각했다. 데이터에는 6가지의 동작이 구분되어 있고, 이 동작을 구분하는 변수들이 존재한다.

<p style="text-align:center;"><strong>6가지의 동작 종류</strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/activity.png" width =700>
</center>

처음에 개인 미션으로 주어진 데이터를 탐색하고, 기본 모델을 (Random Forest 알고리즘 활용) 생성한 후 변수 중요도를 구한다. 그 후 중요한 feature와 중요하지 않은 feature들을 구분하고 각 feature 그룹별 중요도도 파악해보며 데이터와 친해진 후, 이를 활용한 사업아이템을 발굴해보았다. <strong>Feature들을 중요도 순으로 구분해보는 과정은 매우 중요하다. 실무에서는 수천,수만개의 데이터 핸들링이 필요하고, 많은 데이터를 모두 다 핸들링하기보다는 데이터 분석을 통해 데이터의 피쳐를 줄이고 간소화하는 작업을 해보는 것이 프로젝트의 핵심이라고 생각했다.</strong>

데이터에 포함된 변수들은 크게 가속도계로 측정한 Acc(중력가속도), 자이로스코프로 측정한 Gyro(각속도), 가속도의 변화율을 나타내는 Jerk, 자기장 센서로 측정된 Mag, 그리고 각과 관련된 Angle 변수들이 존재한다. 

우선 첫번째로 6가지의 Activity들을 구분하기 위한 데이터 전처리와 모델링을 진행하였다. RandomForest 알고리즘을 사용하였고, 코드를 보면 Target은 'Activity'로 되어있고, 학습하는데 있어서 불필요한 데이터인 Target(예측값이기 때문에)과 동작을 구분하기 위해 1~6의 숫자를 부여한 Activity_num column은 제외하였다. 과적합을 방지하기 위하여 test_size=.3으로 설정하여 검증 데이터는 입력 데이터중 30%로 설정하였다.

<p style="text-align:center;"><strong>데이터 전처리</strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/modeling1.png" width =700>
</center>

<p style="text-align:center;"><strong>모델링</strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/modeling2.png" width =700>
</center>

<p style="text-align:center;"><strong>학습 결과(예측 정확도)</strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/modeling3.png" width =700>
</center>

학습결과와 예측정확도를 보니 과적합된 것 같지는 않았고, 혼자 진행해보며 '잘 예측하는데?'라는 생각을 혼자했었던게 기억이 난다. 이제 학습시킨 모델을 가지고 동작들을 구분하는데 있어서 중요한 변수들을 추출해보았다.

<p style="text-align:center;"><strong>변수 중요도 추출</strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/modeling4.png" width =400 height=360>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/modelresult.png" width =400 height=360>
</center>

6가지의 동작들을 구분하는데 있어서 가장 중요한 feature, 변수는 <strong>tGravityAcc-min()-X</strong>이었고, 결과를 확인해보면 상위 10가지의 변수 중 무려 8개가 중력가속도와 관련된 변수인 것을 확인해볼 수 있었다. 그렇다면 중요도가 높은 변수들의 값을 각각의 6가지의 동작들에서 어떠한 밀집도를 가지며 분포하는지 KDE plot을 통해 확인해보았다.

<p style="text-align:center;"><strong>중요도 Top5 KDE plot</strong></p>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/top5kde.png" width =700>
</center>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/kdeplott.png" width =300 height=360>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/kdeplott2.png" width =300 height=360>
</center>
<center>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/kdeplott3.png" width =300 height=360>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/kdeplott4.png" width =300 height=360>
    <img src="https://rlatmddn0211.github.io/seungwoo_blog.github.io/assets/images/kdeplott5.png" width =300 height=360>
</center>







